{% extends "layout.html" %}
{% block title %}Proforma Fatura DetayÄ±{% endblock %}

{% block body %}
<h2 class="mb-4">ðŸ§¾ Proforma Fatura DetayÄ±</h2>


<div class="border border-secondary-subtle bg-white p-4 rounded mb-4">
  <div class="row">
    <div class="col-md-5 mb-3">
      <div class="text-muted small">Firma AdÄ±</div>
      <div class="fs-5 fw-semibold">{{ invoice.company_name  }}</div>
    </div>
    <div class="col-md-1 mb-3">
      <div class="text-muted small">Para Birimi</div>
      <div class="fs-5 fw-semibold">{{ invoice.get_currency_display }}</div>
    </div>
    <div class="col-md-2 mb-3">
      <div class="text-muted small">Kur</div>
      <div class="fs-5 fw-semibold">{{ invoice.exchange_rate }}</div>
    </div>
    <div class="col-md-2 mb-3">
      <div class="text-muted small">Tarih</div>
      <div class="fs-5 fw-semibold">{{ invoice.created_at|date:"d.m.Y" }}</div>
    </div>
    <div class="col-md-2 mb-3">
      <div class="text-muted small">Proforma ID</div>
      <div class="fs-5 fw-semibold">#{{ invoice.id }}</div>
    </div>
  </div>
</div>

<div class="table-responsive mb-4">
  <table class="table table-bordered text-center align-middle">
    <thead class="table-light">
      <tr>
        <th>ÃœrÃ¼n</th>
        <th>Miktar</th>
        <th>Birim Fiyat ({{ invoice.get_currency_display }})</th>
        <th>Toplam</th>
      </tr>
    </thead>
    <tbody>
      {% for item in invoice.items.all %}
      <tr>
        <td>{{ item.product.name_tr }}</td>
        <td>{{ item.quantity }}</td>
        <td>{{ item.unit_price|floatformat:4 }}</td>
        <td>{{ item.total_price|floatformat:4 }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr class="table-light fw-bold">
        <td colspan="3" class="text-end">Toplam (KDV HariÃ§):</td>
        <td>{{ invoice.get_total_amount|floatformat:4 }} {{ invoice.get_currency_display }}</td>
      </tr>
      <tr class="table-light fw-bold">
        <td colspan="3" class="text-end">KDV (% {{ invoice.vat_rate }}):</td>
        <td>{{ invoice.get_vat_amount|floatformat:4 }} {{ invoice.get_currency_display }}</td>
      </tr>
      <tr class="table-light fw-bold">
        <td colspan="3" class="text-end">Toplam + KDV:</td>
        <td>{{ invoice.get_grand_total|floatformat:4 }} {{ invoice.get_currency_display }}</td>
      </tr>
      <tr class="table-light fw-bold">
        <td colspan="3" class="text-end">TL KarÅŸÄ±lÄ±ÄŸÄ±:</td>
        <td>{{ invoice.get_tl_grand_total|floatformat:4 }} â‚º</td>
      </tr>
    </tfoot>
  </table>
</div>

<div class="d-flex justify-content-between mt-4">
  <a href="{% url 'proforma:create_draft' %}" class="btn btn-outline-primary w-25">
    âž• Yeni Proforma OluÅŸtur
  </a>
  <a href="{% url 'proforma:proforma_pdf' invoice.id %}" target="_blank" class="btn btn-outline-danger w-25">
    <i class="bi bi-file-earmark-pdf me-2"></i>PDF OluÅŸtur
  </a>
</div>


{% endblock %}
